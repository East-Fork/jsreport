!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e||self).jsreport=t()}(this,function(){function e(){return e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},e.apply(this,arguments)}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=function(e){var n={exports:{}};return function(e,n){!function(){function n(e,t,n){var o=new XMLHttpRequest;o.open("GET",e),o.responseType="blob",o.onload=function(){a(o.response,t,n)},o.onerror=function(){console.error("could not download file")},o.send()}function o(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function r(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var i="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof t&&t.global===t?t:void 0,s=i.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),a=i.saveAs||("object"!=typeof window||window!==i?function(){}:"download"in HTMLAnchorElement.prototype&&!s?function(e,t,s){var a=i.URL||i.webkitURL,u=document.createElement("a");u.download=t=t||e.name||"download",u.rel="noopener","string"==typeof e?(u.href=e,u.origin===location.origin?r(u):o(u.href)?n(e,t,s):r(u,u.target="_blank")):(u.href=a.createObjectURL(e),setTimeout(function(){a.revokeObjectURL(u.href)},4e4),setTimeout(function(){r(u)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,i){if(t=t||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(function(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}(e,i),t);else if(o(e))n(e,t,i);else{var s=document.createElement("a");s.href=e,s.target="_blank",setTimeout(function(){r(s)})}}:function(e,t,o,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),"string"==typeof e)return n(e,t,o);var a="application/octet-stream"===e.type,u=/constructor/i.test(i.HTMLElement)||i.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||a&&u||s)&&"undefined"!=typeof FileReader){var l=new FileReader;l.onloadend=function(){var e=l.result;e=c?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=e:location=e,r=null},l.readAsDataURL(e)}else{var f=i.URL||i.webkitURL,d=f.createObjectURL(e);r?r.location=d:location.href=d,r=null,setTimeout(function(){f.revokeObjectURL(d)},4e4)}});i.saveAs=a.saveAs=a,e.exports=a}()}(n),n.exports}();function o(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}var r=/*#__PURE__*/function(){function e(e){this._response=e}var t,o=e.prototype;return o.toString=function(){try{return Promise.resolve(this.response.blob()).then(function(e){return e.text()})}catch(e){return Promise.reject(e)}},o.download=function(e){try{return Promise.resolve(this.response.blob()).then(function(t){n.saveAs(t,e)})}catch(e){return Promise.reject(e)}},o.toBlob=function(){try{return Promise.resolve(this.response.blob())}catch(e){return Promise.reject(e)}},o.toDataURI=function(){try{var e=new FileReader;return Promise.resolve(this.response.blob()).then(function(t){return new Promise(function(n){e.onload=function(t){n(e.result)},e.readAsDataURL(t)})})}catch(e){return Promise.reject(e)}},o.openInWindow=function(e){var t=void 0===e?{}:e,n=t.cleanInterval,o=void 0===n?5e3:n,r=t.windowName,i=t.windowFeatures,s=t.title;try{return Promise.resolve(this.response.blob()).then(function(e){var t=URL.createObjectURL(e,r,i),n=window.URL.createObjectURL(new Blob(["\n    <html>\n      <head>\n        <title>"+(s||"report")+'</title>\n        <style>\n          html, body {\n            margin: 0px;\n            width: 100%;\n            height: 100%;\n          }\n        </style>\n      </head>\n      <body>\n        <iframe src="'+t+'" frameborder="0" width="100%" height="100%" />\n      </body>\n    </html>\n  '],{type:"text/html"})),a=window.open(n),u=setInterval(function(){a&&a.closed&&(URL.revokeObjectURL(t),URL.revokeObjectURL(n),clearInterval(u))},o);return a})}catch(e){return Promise.reject(e)}},o.toObjectURL=function(){try{return Promise.resolve(this.response.blob()).then(URL.createObjectURL)}catch(e){return Promise.reject(e)}},(t=[{key:"response",get:function(){return this._response}}])&&function(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(e.prototype,t),e}(),i=new(/*#__PURE__*/function(){function t(){this.headers={}}var n=t.prototype;return n._jsreportRequest=function(t){var n=t.method,r=t.path,i=t.body;try{var s,a=function(t){var n=function(){if(!s.ok){var t=function(){var e=new Error(n.message);throw Object.assign(e,{status:s.status,statusText:s.statusText,error:n}),e},n={message:"jsreport server responded with error. status text: "+s.statusText+", status code: "+s.status},r=o(function(){return Promise.resolve(s.blob()).then(function(t){return Promise.resolve(t.text()).then(function(t){var o=JSON.parse(t);n=e({},o,{message:n.message+", details: "+o.message})})})},function(){});return r&&r.then?r.then(t):t()}}();return n&&n.then?n.then(function(e){return s}):s},u=this;if(!u.serverUrl)throw new Error("The script was not linked from jsreport. You need to fill jsreport.serverUrl property with valid url to jsreport server.");var c=o(function(){return Promise.resolve(fetch(u.serverUrl+r,{headers:e({"Content-Type":"application/json"},u.headers),body:null!=i?JSON.stringify(i):null,method:n})).then(function(e){s=e})},function(){throw new Error("Failed to connect to jsreport server.")});return Promise.resolve(c&&c.then?c.then(a):a())}catch(e){return Promise.reject(e)}},n._submitFormRequest=function(e,t,n){var o=document.createElement("form");o.target=t,o.id=(new Date).getTime(),o.method="POST",o.action=this.serverUrl+"/api/report/"+encodeURIComponent(n);var r=document.createElement("input");r.type="hidden",r.name="renderRequestContent",r.value=JSON.stringify(e),o.appendChild(r),document.body.appendChild(o),function e(t){if(t>10)return console.log("Unable to submit render form.");try{o.submit(),o.outerHTML=""}catch(n){setTimeout(function(){e(t+1)},50)}}(0)},n.download=function(e,t){var n=Object.assign({},t);n.options=Object.assign({},n.options),null==n.options["Content-Disposition"]&&(n.options["Content-Disposition"]='attachment; filename="'+e+'"'),this._submitFormRequest(n,"_self",e)},n.openInWindow=function(e,t){var n=e.title,o=e.filename,r=Object.assign({},t);o&&(r.options=Object.assign({},r.options),null==r.options["Content-Disposition"]&&(r.options["Content-Disposition"]='inline; filename="'+o+'"')),this._submitFormRequest(r,"_blank",n)},n.render=function(e){try{return Promise.resolve(this._jsreportRequest({method:"POST",path:"/api/report",body:e})).then(function(e){return new r(e)})}catch(e){return Promise.reject(e)}},n.createClient=function(){return new t},t}());return setTimeout(function(){void 0!==window.jsreportInit&&jsreportInit(i)},0),i});
//# sourceMappingURL=jsreport.umd.js.map
